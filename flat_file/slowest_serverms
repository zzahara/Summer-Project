#!/bin/bash
num_accesses=20
echo "<html><head /><body>"
echo "<p>slowest $1 pages (server_ms):</p>"
echo "<p>Displays pages with more than $num_accesses access(es)</p>"
./zd_cut.py -f page -f server_ms \
    | ./zd_sort.py -f page -f server_ms -n server_ms \
    | ./zd_select.py "d['server_ms'] != '-'" \
    | ./zd_stat.py -a ave_serverms -s standard_dev -g page -d server_ms \
    | ./zd_cut.py -f page -f ave_serverms -f standard_dev \
    | ./zd_sort.py -f ave_serverms -g -r -n ave_serverms \
    | ./zd_reorder.py -f ave_serverms -f standard_dev -f page \
    | uniq | head -n $1 \
    | ./flat_to_html.py --header
echo ""
echo "</body> </html>"
